id: CVE-2024-6738
info:
  name: "CVE-2024-6738"
  author: "XD3an"
  severity: medium
  description: "The tumbnail API of Tronclass from WisdomGarden lacks proper access control, allowing unauthenticated remote attackers to obtain certain specific files by modifying the URL."
  reference:
    - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-6738
    - https://nvd.nist.gov/vuln/detail/CVE-2024-6738
    - https://cwe.mitre.org/data/definitions/284.html
  tags: cve, tronclass, wisdomgarden, improper-access-control
  
requests:
  - method: GET
    path:
      - "{{BaseURL}}"

    matchers-condition: and
  
    matchers:
      - type: status
        status: 
        - 200

      - type: word
        words:
        - "Tengine"
        part: header
    
      - type: regex
        regex:
          - "/api/uploads/[0-9]+/modified-image\\?thumbnail=[0-9x]+"
        part: body
